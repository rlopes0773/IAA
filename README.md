# Verifiable Credentials Project - eIDAS 2.0 Aligned

## Project Overview

This project implements a privacy-preserving authentication system using Verifiable Credentials (VCs) aligned with eIDAS 2.0 principles. The system demonstrates how VCs can be used for secure authentication while minimizing data sharing and maximizing user control.

## Project Structure

```
├── issuer and verifier/     # Issuer & Verifier components
│   ├── issuer.js           # VC issuance logic
│   ├── verifier.js         # VC verification logic
│   ├── server.js           # Express server for web interface
│   ├── public/             # Web interface
│   └── contexts/           # JSON-LD contexts
├── holder/                 # Holder component (wallet)
│   └── verifiable-credentials-project/
│       ├── holder.js       # VP creation logic
│       ├── server.js       # Holder web server
│       └── public/         # Wallet interface
└── README.md
```

## Prerequisites

- Node.js 18+ 
- npm

## Installation

1. **Clone the repository**
   ```bash
   git clone <your-repo-url>
   cd verifiable-credentials-eidas-project
   ```

2. **Install all dependencies**
   ```bash
   npm run install:all
   ```

   Or manually:
   ```bash
   # Install issuer/verifier dependencies
   cd "issuer and verifier"
   npm install
   
   # Install holder dependencies  
   cd "../holder/verifiable-credentials-project"
   npm install
   ```

## Running the System

### Option 1: Start Both Components Separately

**Terminal 1 - Start Issuer/Verifier:**
```bash
cd "issuer and verifier"
npm start
```
Access at: http://localhost:3000

**Terminal 2 - Start Holder (Wallet):**
```bash
cd "holder/verifiable-credentials-project"
npm start
```
Access at: http://localhost:3001

### Option 2: Root Startup 
```bash
# Start issuer/verifier from root
npm run start:issuer-verifier

# Start holder from root  
npm run start:holder

# Development mode
npm run dev:issuer-verifier
npm run dev:holder
```

## Usage Flow

### 1. Issue a Credential (Issuer)
1. Open http://localhost:3000
2. Go to "Issuer" tab
3. Fill in student information:
   - Student ID: `did:student:ebfeb1f712ebc6f1c276e12ec21`
   - Name: `João Silva Santos`
   - Degree: `Mestrado em Cibersegurança`
   - Grade: `17.5`
   - Institution: `Universidade de Aveiro`
4. Click "Emitir Credencial"
5. Copy the generated VC JSON

### 2. Create a Presentation (Holder)
1. Open http://localhost:3001
2. Go to "Credencial" tab
3. Upload or paste the VC JSON from step 1
4. Go to "Criar Nova" tab
5. Set challenge and domain:
   - Challenge: `abc123`
   - Domain: `https://example.com/`
6. Click "Criar Apresentação"
7. Copy the generated VP JSON

### 3. Verify the Presentation (Verifier)
1. Return to http://localhost:3000
2. Go to "Verifier" tab
3. Paste the VP JSON from step 2
4. Set same challenge and domain used in step 2
5. Click "Verificar Apresentação"
6. Check verification result

## Command Line Usage

### Issue a Credential
```bash
cd "issuer and verifier"
npm run issue
```

### Create a Presentation
```bash
cd "holder/verifiable-credentials-project"
node holder.js
```

### Verify a Presentation
```bash
cd "issuer and verifier"
npm run verify
```

## Architecture Components

### Issuer
- **Location**: `issuer and verifier/issuer.js`
- **Function**: Creates and signs Verifiable Credentials
- **Context**: Uses custom university degree context
- **Crypto**: ECDSA P-256 with did:key method

### Holder (Wallet)
- **Location**: `holder/verifiable-credentials-project/holder.js`
- **Function**: Stores VCs and creates Verifiable Presentations
- **Features**: Selective disclosure support
- **Interface**: Web-based credential management

### Verifier
- **Location**: `issuer and verifier/verifier.js`
- **Function**: Verifies Verifiable Presentations
- **Validation**: Cryptographic signature and challenge/domain verification

## Key Features

- ✅ W3C Verifiable Credentials Data Model 2.0 compliance
- ✅ Privacy-preserving selective disclosure
- ✅ ECDSA P-256 cryptographic signatures
- ✅ did:key decentralized identifiers
- ✅ Challenge-response authentication
- ✅ Web interfaces for all components
- ✅ eIDAS 2.0 alignment principles

## Troubleshooting

### Common Issues

1. **Context loading errors**: Ensure all context files are present in `contexts/` directories
2. **Crypto errors**: Make sure you're using Node.js 18+
3. **Port conflicts**: Default ports are 3000 (issuer/verifier) and 3001 (holder)
4. **File not found**: Make sure you're in the correct directory when running commands

### File Dependencies
- `vc.json` - Generated by issuer, required by holder
- `vp.json` - Generated by holder, required by verifier
- Context files must be present in both issuer and holder directories

## Technologies Used

- **Node.js** - Runtime environment
- **Express.js** - Web server framework
- **@digitalbazaar** libraries - W3C VC implementation
- **did:key** - Decentralized identifier method
- **ECDSA P-256** - Cryptographic signature algorithm
- **JSON-LD** - Linked data format

## Project Team

- Diogo Neto (124057)
- Hugo Silva (86157)  
- Rúben Lopes (103009)

**Course**: Cibersegurança  
**Subject**: Identificação, Autenticação e Autorização  
**Institution**: Universidade de Aveiro  
**Year**: 2024/2025